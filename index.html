<!doctype html>
<html lang="en">

	<head>
		<meta charset="utf-8">

		<title>Browser Dance Party</title>

		<meta name="description" content="Browser Dance Party">
		<meta name="author" content="Jordan Santell">

		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

		<link rel="stylesheet" href="vendor/styles/reveal.css">
		<link rel="stylesheet" href="css/theme.css">
		<link rel="stylesheet" href="vendor/styles/prettify.css">
		<link rel="stylesheet" href="vendor/styles/font-awesome.css">

		<!--[if lt IE 9]>
		<script src="vendor/scripts/html5shiv.js"></script>
		<![endif]-->
	</head>

	<body>

		<div class="reveal">

			<!-- Any section element inside of this container is displayed as a slide -->
			<div class="slides">
				<section>
					<h1>Browser Dance Party</h1>
					<h3>HTML5 Audio Visualizers</h3>
					<p>
						<a href="http://jsantell.com">
							Jordan Santell
						</a> /
						<a href="http://twitter.com/jsantell">
							@jsantell
						</a>
					</p>
				</section>

				<section>
					<h1>Who is this guy</h1>
					<img class="left" src="images/redpandalasers.gif"/>
					<ul class="right">
						<li>Mozilla Addon-SDK</li>
						<li><a href="http://github.com/web-audio-components/">web audio components</a> </li>
						<li><a href="http://github.com/jsantell/dancer.js">dancer.js</a> creator</li>
					</ul>
					<img class="right" src="images/dancerjs.jpg" />
				</section>

				<section class="road-map">
					<h1>Dance Journey</h1>
					<div class="map-section map-viz">
						<div class="goal complete">Visualizers</div>
						<div class="goal complete">Beat Detection</div>
					</div>
					<div class="map-section map-imp">
						<div class="goal complete">Web Audio API</div>
						<div class="goal complete">Buffer Node</div>
						<div class="goal complete">Analyser Node</div>
						<div class="goal complete">Script Processor</div>
					</div>
					<div class="map-section map-dsp">
						<div class="goal complete">DSP</div>
						<div class="goal complete">Time Domain</div>
						<div class="goal complete">Freq. Domain</div>
					</div>
				</section>
				<section class="road-map">
					<h1>Dance Journey</h1>
					<div class="map-section map-viz">
						<div class="goal complete">Visualizers</div>
						<div class="goal complete">Beat Detection</div>
					</div>
					<div class="map-section map-imp">
						<div class="goal">Web Audio API</div>
						<div class="goal">Buffer Node</div>
						<div class="goal">Analyser Node</div>
						<div class="goal">Script Processor</div>
					</div>
					<div class="map-section map-dsp">
						<div class="goal">DSP</div>
						<div class="goal">Time Domain</div>
						<div class="goal">Freq. Domain</div>
					</div>
				</section>
				<section class="road-map">
					<h1>Dance Journey</h1>
					<div class="map-section map-viz">
						<div class="goal">Visualizers</div>
						<div class="goal">Beat Detection</div>
					</div>
					<div class="map-section map-imp">
						<div class="goal complete">Web Audio API</div>
						<div class="goal complete">Buffer Node</div>
						<div class="goal complete">Analyser Node</div>
						<div class="goal complete">Script Processor</div>
					</div>
					<div class="map-section map-dsp">
						<div class="goal">DSP</div>
						<div class="goal">Time Domain</div>
						<div class="goal">Freq. Domain</div>
					</div>
				</section>
				<section class="road-map">
					<h1>Dance Journey</h1>
					<div class="map-section map-viz">
						<div class="goal">Visualizers</div>
						<div class="goal">Beat Detection</div>
					</div>
					<div class="map-section map-imp">
						<div class="goal">Web Audio API</div>
						<div class="goal">Buffer Node</div>
						<div class="goal">Analyser Node</div>
						<div class="goal">Script Processor</div>
					</div>
					<div class="map-section map-dsp">
						<div class="goal complete">DSP</div>
						<div class="goal complete">Time Domain</div>
						<div class="goal complete">Freq. Domain</div>
					</div>
				</section>
				<section class="road-map">
					<h1>Dance Journey</h1>
					<div class="map-section map-viz">
						<div class="goal complete">Visualizers</div>
						<div class="goal complete">Beat Detection</div>
					</div>
					<div class="map-section map-imp">
						<div class="goal complete">Web Audio API</div>
						<div class="goal complete">Buffer Node</div>
						<div class="goal complete">Analyser Node</div>
						<div class="goal complete">Script Processor</div>
					</div>
					<div class="map-section map-dsp">
						<div class="goal complete">DSP</div>
						<div class="goal complete">Time Domain</div>
						<div class="goal complete">Freq. Domain</div>
					</div>
				</section>
				<section>
					<h1>Awesome Example</h1>
					<p>
						<a href="http://do.adive.in/music/">A Dive In Music</a> by <a href="http://twitter.com/_vor">Benoit Damien</a>
					</p>
					<img src="images/doadive.png" />
				</section>
<!--
				<section>
					<h1>Visualizers</h1>
					<video controls>
						<source src="videos/itunes.webm" type='video/webm' />
						<source src="videos/itunes.mp4" type='video/mp4' />
						HTML5 Video not supported
					</video>
					</section>
-->
				<section class="road-map">
					<h1>Dance Journey</h1>
					<div class="map-section map-viz">
						<div class="goal active">Visualizers</div>
						<div class="goal">Beat Detection</div>
					</div>
					<div class="map-section map-imp">
						<div class="goal">Web Audio API</div>
						<div class="goal">Buffer Node</div>
						<div class="goal">Analyser Node</div>
						<div class="goal">Script Processor</div>
					</div>
					<div class="map-section map-dsp">
						<div class="goal">DSP</div>
						<div class="goal">Time Domain</div>
						<div class="goal">Freq. Domain</div>
					</div>
				</section>
				<section>
					<h1>Visualizers</h1>
					<ul>
						<li>Procedurally generated using audio data</li>
						<li>Deterministic or non-deterministic</li>
					</ul>
					<img src="images/itunes.png" />
				</section>
				<section class="road-map">
					<h1>Dance Journey</h1>
					<div class="map-section map-viz">
						<div class="goal complete">Visualizers</div>
						<div class="goal">Beat Detection</div>
					</div>
					<div class="map-section map-imp">
						<div class="goal active">Web Audio API</div>
						<div class="goal">Buffer Node</div>
						<div class="goal">Analyser Node</div>
						<div class="goal">Script Processor</div>
					</div>
					<div class="map-section map-dsp">
						<div class="goal">DSP</div>
						<div class="goal">Time Domain</div>
						<div class="goal">Freq. Domain</div>
					</div>
				</section>
				<section>
					<h1>Web Audio API</h1>
					<img src="images/modularrouting.png" />
				</section>
				<section>
					<h1>Web Audio Caveats</h1>
					<img class="left" src="images/browserwar.jpg" />
					<ul class="right">
						<li>One AudioContext per doc</li>
						<li>Prefixed AudioContexts</li>
						<li>Deprecated APIs</li>
						<li>Browser Codec Wars</li>
					</ul>
				</section>
				<section>
					<h1>Support</h1>
					<ul class="browsers">
						<li><div class="firefox browsers"></div><div><i class="icon-check icon-4x partial"></i><span>v25+</span></div></li>
						<li><div class="chrome browsers"></div><div><i class="icon-check icon-4x partial"></i><span>prefixed</span></div></li>
						<li><div class="safari browsers"></div><div><i class="icon-check icon-4x partial"></i><span>prefixed, deprecated APIs</span></div></li>
						<li><div class="opera browsers"></div><div><i class="icon-check icon-4x partial"></i><span>prefixed, deprecated APIs</span></div></li>
						<li><div class="ie browsers"></div><div><i class="icon-frown notsupported icon-4x"></i><span>Not in v11, <a href="http://connect.microsoft.com/IE/feedback/details/799529/web-audio-api-support">future plans</a></div></li>

					</ul>
				</section>
				<section>
					<h1>Web Audio API Nodes</h1>
					<ul class="float-column">
						<li class="title">Source</li>
						<li>Media Element</li>
						<li>Media Stream</li>
						<li>Oscillator</li>
						<li>Buffer</li>
					</ul>
					<ul class="float-column">
						<li class="title">Utility</li>
						<li>Script Proc.</li>
						<li>Analyser</li>
						<li>Chan. Splitter</li>
						<li>Chan. Merger</li>
					</ul>
					<ul class="float-column">
						<li class="title">Effect</li>
						<li>Gain</li>
						<li>Biquad Filter</li>
						<li>Delay</li>
						<li>Convolver</li>
						<li>Compressor</li>
						<li>WaveShaper</li>
					</ul>
				</section>
				<section>
					<h1>Web Audio API Nodes</h1>
					<ul class="float-column">
						<li class="title">Source</li>
						<li>Media Element</li>
						<li>Media Stream</li>
						<li>Oscillator</li>
						<li class="highlight">Buffer</li>
					</ul>
					<ul class="float-column">
						<li class="title">Utility</li>
						<li class="highlight">Script Proc.</li>
						<li class="highlight">Analyser</li>
						<li>Chan. Splitter</li>
						<li>Chan. Merger</li>
					</ul>
					<ul class="float-column">
						<li class="title">Effect</li>
						<li>Gain</li>
						<li>Biquad Filter</li>
						<li>Delay</li>
						<li>Convolver</li>
						<li>Compressor</li>
						<li>WaveShaper</li>
					</ul>
				</section>
				<section>
					<h1>Web Audio API</h1>
					<img src="images/guitar-route-1.png" />
				</section>
				<section>
					<h1>Web Audio API</h1>
					<img src="images/guitar-route-web-audio.png" />
				</section>
				<section>
					<h1>Simple Route</h1>
					<pre>
var ctx = new AudioContext();
var dest = ctx.destination;
var osc = ctx.createOscillator();
var gain = ctx.createGain();
osc.connect(gain);
gain.connect(dest);
osc.start(0);
					</pre>
				</section>
<!--
				<section>
					<h1>Web Audio API</h1>
					<img src="images/band-route-1.png" />
				</section>
				<section>
					<h1>Web Audio API</h1>
					<img src="images/band-route-web-audio.png" />
				</section>
-->
				<section class="road-map">
					<h1>Dance Journey</h1>
					<div class="map-section map-viz">
						<div class="goal complete">Visualizers</div>
						<div class="goal">Beat Detection</div>
					</div>
					<div class="map-section map-imp">
						<div class="goal complete">Web Audio API</div>
						<div class="goal active">Buffer Node</div>
						<div class="goal">Analyser Node</div>
						<div class="goal">Script Processor</div>
					</div>
					<div class="map-section map-dsp">
						<div class="goal">DSP</div>
						<div class="goal">Time Domain</div>
						<div class="goal">Freq. Domain</div>
					</div>
				</section>
				<section>
					<h1>Buffer Source</h1>
					<ul>
						<li>Getting array buffers via XHR</li>
						<li>Audio files are binary!</li>
					</ul>
				</section>
				<section>
					<h1>Array Buffers</h1>
					<pre>
function getBuffer (url, callback) {
  var xhr = new XMLHttpRequest();
  xhr.open('GET', url, true);
  xhr.responsetype = 'arraybuffer';
  xhr.onload = function () {
    callback(xhr.response);
  }
  xhr.send();
}
					</pre>
				</section>
				<section>
					<h1>Decoding Buffers</h1>
					<pre>
function decode (url, cb) {
  getBuffer(url, function (buffer) {
    ctx.decodeAudioData(buffer, cb);
  });
}
					</pre>
				</section>
				<section>
					<h1>Playing Buffers</h1>
					<pre>
var ctx = new AudioContext();
var source = ctx.createBufferSource();
decode('jams.ogg', decodedBuffer => {
  source.buffer = decodedBuffer;
  source.connect(ctx.destination);
  source.start(0);
});
					</pre>
				</section>
<!--
				<section>
					<h1>Buffer + Filter</h1>
					<input type="range" step="10" id="demo-buffer-slider" min="200" max="2000" />
					<div id="demo-buffer-feedback" class="feedback"></div>
					<a href="#" id="demo-buffer-controls" class="btn control-button">
						<i class="icon-play icon-4x"></i>
					</a>
					</section>
-->
				<section class="road-map">
					<h1>Dance Journey</h1>
					<div class="map-section map-viz">
						<div class="goal complete">Visualizers</div>
						<div class="goal">Beat Detection</div>
					</div>
					<div class="map-section map-imp">
						<div class="goal complete">Web Audio API</div>
						<div class="goal complete">Buffer Node</div>
						<div class="goal">Analyser Node</div>
						<div class="goal">Script Processor</div>
					</div>
					<div class="map-section map-dsp">
						<div class="goal active">DSP</div>
						<div class="goal">Time Domain</div>
						<div class="goal">Freq. Domain</div>
					</div>
				</section>
				<section>
					<h1>DSP</h1>
					<img class="left" src="images/dsp.jpg" />
					<ul class="right">
						<li>Interpretting Discrete Signals</li>
						<li>Audio is just values over time!</li>
					</ul>
					</section>
				<section>
					<h1>Sample Rate</h1>
					<img src="images/samplerate.png" />
				</section>
				<section>
					<h1>Bit Depth</h1>
					<img src="images/bitdepth.png" />
				</section>
				<section>
					<h1>Quality</h1>
					<img src="images/bitsample.png" />
				</section>
				<section class="road-map">
					<h1>Dance Journey</h1>
					<div class="map-section map-viz">
						<div class="goal complete">Visualizers</div>
						<div class="goal">Beat Detection</div>
					</div>
					<div class="map-section map-imp">
						<div class="goal complete">Web Audio API</div>
						<div class="goal complete">Buffer Node</div>
						<div class="goal">Analyser Node</div>
						<div class="goal">Script Processor</div>
					</div>
					<div class="map-section map-dsp">
						<div class="goal complete">DSP</div>
						<div class="goal active">Time Domain</div>
						<div class="goal">Freq. Domain</div>
					</div>
				</section>
				<section>
					<h1>Time Domain</h1>
					<input type="range" step="10" id="demo-oscillator-slider" min="300" max="2000" />
					<div class="btn-group">
						<a href="#" id="demo-oscillator-sine" class="btn">
							<i class="icon-usd icon-rotate-90 icon-4x"></i>
						</a>
						<a href="#" id="demo-oscillator-square" class="btn">
							<i class="icon-stop icon-4x"></i>
						</a>
						<a href="#" id="demo-oscillator-sawtooth" class="btn">
							<i class="icon-bolt icon-rotate-90 icon-4x"></i>
						</a>
					</div>
					<canvas id="canvas-oscillator" width="960px" height="300px"></canvas>
					<div class="clear"></div>
					<a href="#" id="demo-oscillator-controls" class="btn control-button">
						<i class="icon-play icon-4x"></i>
					</a>
				</section>
				<section>
					<h1>Time Domain</h1>
					<img src="images/soundcloud.png" />
					<img src="images/audacity1.png"/>
				</section>
				<section>
					<h1>ENHANCE</h1>
					<img src="images/audacity1.png"/>
				</section>
				<section>
					<h1>ENHANCE</h1>
					<img src="images/audacity2.png"/>
				</section>
				<section>
					<h1>ENHANCE</h1>
					<img src="images/audacity3.png"/>
				</section>
				<section>
					<h1>ENHANCE</h1>
					<img src="images/audacity4.png"/>
				</section>
				<section>
					<h1>Time Domain</h1>
					<canvas id="canvas-timedomain" width="960px" height="300px"></canvas>
					<div class="clear"></div>
					<a href="#" id="demo-timedomain-controls" class="btn control-button">
						<i class="icon-play icon-4x"></i>
					</a>
				</section>
				<section class="road-map">
					<h1>Dance Journey</h1>
					<div class="map-section map-viz">
						<div class="goal complete">Visualizers</div>
						<div class="goal">Beat Detection</div>
					</div>
					<div class="map-section map-imp">
						<div class="goal complete">Web Audio API</div>
						<div class="goal complete">Buffer Node</div>
						<div class="goal">Analyser Node</div>
						<div class="goal">Script Processor</div>
					</div>
					<div class="map-section map-dsp">
						<div class="goal complete">DSP</div>
						<div class="goal complete">Time Domain</div>
						<div class="goal active">Freq. Domain</div>
					</div>
				</section>
				<section>
					<h1>Frequency Domain</h1>
					<video controls>
						<source src="videos/monstercat.webm" type='video/webm' />
						<source src="videos/monstercat.mp4" type='video/mp4' />
						HTML5 Video not supported
					</video>
				</section>
<!--
				<section>
					<h1>Time -> Freq?</h1>
					<ul>
						<li>Every signal can be reduced to a series of sine waves (Fourier Series)</li>
						<li>Sine waves map to frequencies</li>
						<li>Algorithms (DFT/FFT) convert Time Domain to Frequency Domain</li>
					</ul>
				</section>
				<section>
					<h1>Fourier Series</h1>
					<img src="images/fft1.png" />
				</section>
				<section>
					<h1>Fourier Series</h1>
					<img src="images/fft2.png" />
				</section>
				<section>
					<h1>Fourier Series</h1>
					<img src="images/fft3.png" />
				</section>
				<section>
					<h1>Fourier Series</h1>
					<img src="images/fft4.png" />
				</section>
-->
				<section>
					<h1>Frequency Domain</h1>
					<canvas id="canvas-frequencydomain" width="960px" height="300px"></canvas>
					<div class="clear"></div>
					<a href="#" id="demo-frequencydomain-controls" class="btn control-button">
						<i class="icon-play icon-4x"></i>
					</a>
				</section>
				<section class="road-map">
					<h1>Dance Journey</h1>
					<div class="map-section map-viz">
						<div class="goal complete">Visualizers</div>
						<div class="goal">Beat Detection</div>
					</div>
					<div class="map-section map-imp">
						<div class="goal complete">Web Audio API</div>
						<div class="goal complete">Buffer Node</div>
						<div class="goal active">Analyser Node</div>
						<div class="goal">Script Processor</div>
					</div>
					<div class="map-section map-dsp">
						<div class="goal complete">DSP</div>
						<div class="goal complete">Time Domain</div>
						<div class="goal complete">Freq. Domain</div>
					</div>
				</section>
				<section>
					<h1>Analyser Node</h1>
					<ul>
						<li>analyser.<strong>getFloatFrequencyData</strong>(array)</li>
						<li>analyser.<strong>getByteFrequencyData</strong>(array)</li>
						<li>analyser.<strong>getByteTimeDomainData</strong>(array)</li>
					</ul>
				</section>
				<section>
					<h1>Frequency Data</h1>
					<img src="images/fftrender.png" />
					<ul>
						<li><strong>nyquist</strong>: Half of sample rate</li>
						<li><strong>binCount</strong>: half of "FFT size"</li>
						<li>Results in frequency data typed array of <strong>binCount</strong> length</li>
						<li>Frequency data contains magnitude data for frequencies 0 to <strong>nyquist</strong></li>
					</ul>
				</section>
				<section>
					<h1>Frequency Data</h1>
					<ul>
						<li>sampleRate = 44100</li>
						<li>nyquist = 44100 / 2</li>
						<li>bins = 1024 / 2</li>
						<li><strong>frequencies per bin</strong>: nyquist / bin</li>
						<li>Each bin (element) contains a range of <strong>43.066</strong> frequencies</li>
					</ul>
					<pre>
data[0]; // 0-43hz
data[1]; // 44-87hz
data[bins-1]; // 22.00khz-22.05khz
					</pre>
				</section>
				<section>
					<h1>Frequency Data</h1>
					<p>Fill Uint8Array with 8-bit values of fftSize/2</p>
					<pre>
var a = ctx.createAnalyser();
a.fftSize = 512;
// a.frequencyBinCount == 256
var freq = new Uint8Array(256);
setInterval(function () {
  a.getByteFrequencyData(freq)
}, 20);
					</pre>
				</section>
				<section>
					<h1>Time Data</h1>
					<p>Fill Uint8Array with 8-bit values of fftSize</p>
					<pre>
var a = ctx.createAnalyser();
a.fftSize = 512;
var data = new Uint8Array(a.fftSize);
setInterval(function () {
  a.getByteTimeDomainData(data)
}, 20);
					</pre>
				</section>
				<section class="road-map">
					<h1>Dance Journey</h1>
					<div class="map-section map-viz">
						<div class="goal complete">Visualizers</div>
						<div class="goal">Beat Detection</div>
					</div>
					<div class="map-section map-imp">
						<div class="goal complete">Web Audio API</div>
						<div class="goal complete">Buffer Node</div>
						<div class="goal complete">Analyser Node</div>
						<div class="goal active">Script Processor</div>
					</div>
					<div class="map-section map-dsp">
						<div class="goal complete">DSP</div>
						<div class="goal complete">Time Domain</div>
						<div class="goal complete">Freq. Domain</div>
					</div>
				</section>
				<section>
					<h1>Script Processor</h1>
					<pre>
var p = ctx.createScriptProcessor(
  2048, 1, 1
);
p.onaudioprocess = function (e) {
  var buf = e.outputBuffer;
  var out = buf.getChannelData(0);
  for (var i=0;i&lt;out.length;i++) {
    out[i] = Math.random() * 2 -1;
  }
};
					</pre>
				</section>
				<section>
					<h1>Script Processor</h1>
					<pre>
var BUFFER_SIZE = 2048;
var p = ctx.createScriptProcessor(
  BUFFER_SIZE
);
p.onaudioprocess = function (e) {
  // Called SAMPLE_RATE / BUFFER_SIZE
  // times a second
};
					</pre>
				</section>
				<section>
					<h1>Analyser+Proc</h1>
					<pre>
var a = ctx.createAnalyser();
var p = ctx.createScriptProcessor(
  2048
);
a.fftSize = 1024;
var fft = new Uint8Array(512);
					</pre>
				</section>
				<section>
					<h1>Analyser+Proc</h1>
					<pre>
p.onaudioprocess = render;
function render () {
  a.getByteFrequencyData(fft);
  // `fft` has 512 elements
  // containing 8 bit values
  // every 46ms
}
					</pre>
				</section>
				<section>
					<h1>More Visualizers</h1>
					<p><a href="http://airtightinteractive.com/demos/js/reactive/">Loop Waveform Visualizers</a> by <a href="http://twitter.com/felixturner">Felix Turner</a>
					</p>
					<p>Example of using both Time and Frequency Domain data</p>
					<img src="images/loopviz.png" />
				</section>
				<section class="road-map">
					<h1>Dance Journey</h1>
					<div class="map-section map-viz">
						<div class="goal complete">Visualizers</div>
						<div class="goal active">Beat Detection</div>
					</div>
					<div class="map-section map-imp">
						<div class="goal complete">Web Audio API</div>
						<div class="goal complete">Buffer Node</div>
						<div class="goal complete">Analyser Node</div>
						<div class="goal complete">Script Processor</div>
					</div>
					<div class="map-section map-dsp">
						<div class="goal complete">DSP</div>
						<div class="goal complete">Time Domain</div>
						<div class="goal complete">Freq. Domain</div>
					</div>
				</section>
				<section>
					<h1>Beat Detection</h1>
					<ul>
						<li>Beats are drastic changes in sound energy</li>
					</ul>
				</section>
				<section>
					<h1>Beat Detection</h1>
					<img src="images/beats.png" />
				</section>
				<section>
					<h1>Average Magnitude</h1>
					<pre>
function getMag(data, min, max) {
  var total = 0;
  for (var i = min; i &lt; max; i++) {
    total += data[i];
  }
  return total / (max - min + 1);
}
					</pre>
				</section>
				<section>
					<h1>Is it a beat?</h1>
					<pre>
function process (d) {
  var mag = getMag(d, 0, d.length);
  if (mag &lt; threshold) beat(mag);
  else {
    threshold -= decayRate;
  }
}
					</pre>
				</section>
				<section>
					<h1>Beat Detection</h1>
					<canvas id="canvas-beat" width="960px" height="300px"></canvas>
					<div class="clear"></div>
					<a href="#" id="demo-beat-controls" class="btn control-button">
						<i class="icon-play icon-4x"></i>
					</a>
				</section>
				<section class="road-map">
					<h1>Dance Journey</h1>
					<div class="map-section map-viz">
						<div class="goal complete">Visualizers</div>
						<div class="goal complete">Beat Detection</div>
					</div>
					<div class="map-section map-imp">
						<div class="goal complete">Web Audio API</div>
						<div class="goal complete">Buffer Node</div>
						<div class="goal complete">Analyser Node</div>
						<div class="goal complete">Script Processor</div>
					</div>
					<div class="map-section map-dsp">
						<div class="goal complete">DSP</div>
						<div class="goal complete">Time Domain</div>
						<div class="goal complete">Freq. Domain</div>
					</div>
				</section>
			</div>
		</div>

		<script src="build/build.js"></script>

	</body>
</html>
